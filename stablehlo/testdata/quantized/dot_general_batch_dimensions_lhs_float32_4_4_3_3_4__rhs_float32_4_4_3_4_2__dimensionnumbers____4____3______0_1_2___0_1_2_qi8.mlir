// RUN: stablehlo-translate --interpret -split-input-file %s

module attributes {jax.uses_shape_polymorphism = true} {
  func.func @main() -> tensor<i1> {
    %cst = stablehlo.constant dense<"0x4D56A1C0941C1B3E749EF6BFAAEB37C0B327D3BFA8562140C3BA9E3F9F4F43BF6E370840F6732CBFB80A34BF451F26C0B992AD3EF50D9840BD9D073F7A81DA40A4AF503F664240C05C7E353FC6F7C03E191098BEB570B7C05F759D40265DAB40D39E72BF8D2AC1C00249B4C0795830C0531DDE3ECC8626C0047052BEE43D23BF66DA4BBF97EAA8BFD6EE2ABD8C43C53E601CA2C0FC040D417D6D0540CE1A193F1B054BC023051940376B48C067C0A7BF0E48184079D9B440755A01C0B6D799C052C4803F548FDB3C9506B0BFC803FEBFBF1F3B3FA7A681BF8B222440C124F340F7849CC062A87C3F951FA63F404F2FBEBE5CD6BF41D5C13FEC4B81BF1AD6A04060B9B2BF1C5990C06E03BDBF9296D2BF0D6CE23F1244B3401D46943F2357F3BFAB7977BF0F3717C011119B3F23EA284066ED7E409377B83FAF9257BFC3E980C050CCEEBF427E7DC025EE2ABF217B943F02C9A8BFFE7A9B3FCA63014098F22C40D6FFCDBF0D1DB33EF20EAC3F31CF8340D18A2640DDB31BC0BC70C2C097F3A340A67D82401AE2993F5572C1C0F4840440D9E0F9BF9570E4BF725D284030AAF4BF217369BFA59E3EBEB1EE1FC06A60B8C0CB3245C0A4E456BEB1D551BE0256A540561291405AB05EBF49D367C0679D1C407D835E3F4F4A6740C1F48C3FF8BC81404DAC7740BF481340A27F903F22871C40C32B99C00B7432404BBD3DBF32369EC0EE9B3A402101FB3F9B748AC029F6114067BA11C06C1851C032AC333F49EFA13E959A9EBF158171BFC86187C057F905C08A3B8740F4231640E3634C402D0193BF3B89163F1E8F36C0D24855C06B451040B78FEC3FDEAF803E234617C0AD113B3F08C5CD3F507157C0A5AB1D4092592E3F8AA4DBBFF81082BD1DFC713F66BA80BF6EB4513F34D099BEFC6DE93F87B60CC027106D3F8A35003FEFB31F403D4D6EBFBCCD6ABFCB4701C0AF4D2EC0C5C6A03FA90B813E4F5328BF3B770F3F2E26C7405FE5AFBF38EC4340998CBCBE11464DBEEC8119C0798AB0BF20C3A6BF2FEC35C0D5FD9740C5B933403DF15DC0DFFD093CFC927DBE69F18B400E0989C020FFC03F8BA24F3FFAAF463DC9A7B43FBD15A93F281FC5BEFCA7D34029B861407DFE2C3F49D67AC08B32323F3021533EF6035B40BCFB0DC09ACCFA3BB8C2DDBFD8E70E3EAC5B9D4048AD25C0A8149BBFD3FF4F404419C4C070FD073F4775A83F1CB1E8BF083C1B3F413705C065498040FB575740651C6540FFC882402E281C40FC0E8E406594273D49FE7BC0F56DADBED5399CBF352186C0791239C0FF6496409DD40D4101FF623FA2BFE7BF3CB71140EF6F63BE023B9FC0235E99C07BFEF4C033C9A9C0D92D28401ECB2F3FE559B43FF2DE5D3F9821623FE2FF7EC01C00304052E0CABE8E47BE3F5D6B35C09BE7D83F4BF134BFB12B3D4073275240091132C0D76A03C0E40E39C0B6B2093D404E21BE9A12E5BF8C62093E21A7D3BFE41D8B3FAB2305407D0C46BFB7C5F43FF71F70C074BCB24051E23C404AE8404092BCBFC02C3A1340C1AD8CC07EB3D5BFE41F24C05083C53FBF76983F455B6EBEFC003B407482B0408AD5774038B5643BB82CAE40B24F98C0198F0F40B9A4E53D86C318C0211186C0AD33C73D5DC2E9BF2E3A1DC08DDC6DC0BD698EC0E7889840CB851640CAF2624096E458C0E1AF58C082443CC0DE2B2DBFCA41E73D80AD6B3FD48632C02E93F03FFDAF893E85E1ADBFA6CEB63FB5FEB83F02239D3FB6D514C01CAFF23E0CE3ED3FAAA1B3BFCEEABC3F8A2FCCC00FE6CFBF553C3BC0F1D10EC07F859F3F6421C9BF29F7A23FB9CD7C3FA57EAE3DE4726BBF677A70C068ADC83D8B2547BE0EF38B3F7CDBB4BF70C4913F08E7F5BF9C6424401A013D401CF73B3F1862B2C0E4E8A340D926233C6F0BC3BE1585E0BF80DF4DC0B7D32640C384893F526DF2C04B2D903F374AB2401466424054BC1640D9431DC0E5F6A53F059A2BC09E1051C0BBD48F3F8F506CC02D88294083A81341ACC16B407352833DB11D5940A3A85E40D4C022C0ED35AEBFD115A43FA6199D4059088DBE28C79540B2D4AEBF177672C0FA2797BFFBF6D4BEB2A221BFB731A63E986E0D40F394B54046F442C0C8579EC05091734017F0DA40A77E28C0C20E1AC0F422F73F448555C0C9B94BC058920A3F1E9D98C038D639C09DFE13405AB6A83E618B9B4043644F40FF104B409B074E402F91B440DD83A9BF17FDE8BFA01B6CBE057E7ABF1F548E403EDD8640DA06C9BF279C1CC02062463FA8B41F405BC80A40003E563F1E37BEC0A8A98D3F2BD38D405B388040007480407A6A2740E0C6B3402BF953BDB7ADD7BFFB0B3E407E198340BE748EB9BDB9643F00F09040D8C9AC3FACF6BEBF49E1C93E73D0A7403C065BC04DEF8E40A0392ABF7D72A84049910EC027C421400F7088C035590BC0A57D45C08731044031BDEABFEE343B40E39FCD3FBB696DC0E27A04BEF9285B4092290B3FBA6193BE6125F53E68FF7BBF530E2B3FB9ADCCBF995728405BA20DC0FA3F303F19DE823FF4EFFCC0F0186BBDE238283FACAA65BF163CFA3FCAF7FA3ED58C3BC06738E9BD336007BE6F4C6140339E4540354FA83F04CC4AC0DB607DBFC43D9440A1F12DC02BFEC63ED6D03CC09F6BA240B21E9EBFAD9A5DBE0C26F03FED7DEE3FE41599408B7DF640812DE93E834CA4BF897548C0386757C03493A0BF8CF2233E165FB03F95058DC04E6B1440682FEF3F2396694052108BC095C1C5BFFD13833F1F704FC0859B18C1FF87673F4E203CC08C4F7D400B6DB6C0CF2341403AFD04C0D08FAF4046FE6B3F4FC594C0C8D02740495A0441FAC7FCBF43D6773D56BFCDBF014452BFBD1803C0DCDD62402E863EC08440E8BE39667BC080D93D40B5A6A5BE03E75440AF061FC075B32C40E6DB7B402B6A1F3FC8E58BBF8D0628C0911D453F680B08C067F4E1C0A17D523F78488CBD847FC5BF9A5507407624C53F5706A940716AB93FD03927C08210E43CF49A8B3FFD9C8A3FDC9683403E9950C0CC020340E27DBE3E46A35AC0DEC12BC1F1EDE5BF4BDEEEBF8DF39D406E72823FE1D7314051B65340DF668F3FDB8061C05875DABF34DFA7BE264DB23FEAC8DCBFC9A7A73E9FBA40BD383497406CE48D40F73F1D400E4617BFA98787C00408A940BAFE453FD60B16C060B606404716AC40BDC02E3F09897140854A78409496BCBFB0941EC009B254406DC32CC0A0C637C0C659D93F89BB07C0274DC53FC9182EC0FCB0E33F48DB80BD"> : tensor<4x4x3x3x4xf32>
    %cst_0 = stablehlo.constant dense<"0x4AFA57C0C5DAD8BFD5C028C08B555F40243C7140BDDFD9BFF8C008BFA943B5C0061F4E3FB1EC9AC05B8F983ED9351F4070090240EA443D40C0BA8BBFF2F24AC03DDCAEBD00D1B4BFFB95BD3E67C782C09103C8406DD4D43FCF0C0A3F855DDB3F538E944085752BC092423E408EFFB8BF5D0E36C000CE874022C982BF963CD9BFF47D99401E4016400571423E74AA2E40D4511B405122603F875E9C3F12F7B23FFD70A7BF03B9E13C4EE9574097CB70C01B3811BF71496BC0D291864098D196C0CE3F52BFD2DC9D3FE34886409E7CA9C02A4402C00E0F7C408892B1BF60E7F03ED5E3E0BF5826DBBEEBD97B3F0B2E133E6A5260C02BEDC3C03536114093B9C0C0FE2EFC3FF7757CBECC3DB4C0062BBCBF88F201C0F073F6C0B62BC13F70320DBF46DFC53F927088BFE3CABA3E55C7FBBF577D6A3D549B9340CB594040F37FB34052C36AC085AE47C088AC55BF597E4DC0DC01CD3EC20D303F2A0C8540191EFF3F4E559FBF4C6D61C0DED87E40FA5C9BC08C31B63F4FD881C0DD135F403CCF4D40C7B61BBFCAD3234091285EBFE2E1A44037A428C168B24A40F3F84F40673836BF6644EFBE7EB203BECB5E9E40D2457C40FAF8C83F08FBC94073B16F3E26DDE0BF14FF8D3FA3F1B0C05FCBC23E62C1BB3FE55711BF961F2BC0302BCEBEB78CD4BF96513B40077600C03FD545BF170DB9BFCD31AD4033FC0840C1668C40966B8D3F3C0B3640DC949B3FCC176EC0D23BDC3F7A6A28BEE25624C0D2982540D9704E4044D42AC056324840F3FDAF40A9AE9C3F9CA199C077FF11C05E700BC0FE2F15BFA332713FBB0A983F2BE005C111058240AEF31EC06BD402BFC4BD83C072AC2540164300BF41C94CC024C7A340E4030541623023C08EED9B40B2410C4115721DBF2946BFBFC265F73FAA84A4BF9D1BC83F72EC474030306E40B39BFA3FC882BEBF73EF32BE27A534C0654836BE828E9DBFF31F373F98AE4E40766093C0D66E533F6AA185BF04768740F0D3863FB3E2C3BF3ABC75BFF546673D7D7F3FC0B34E6DC04980EE3B3AE04AC023A3193E0BB11C4043DB38405F39FFBF55EB053F245465C023708A3F12A881407B3A81C08BA401C0FA640D400176F83EF3C8E3BF2FAF453F5CC9E53F9C49443F1887B13FAB3183BFA5E33440050A634037A728BE13DCAABEBAD5A7BF4A6862407CDD653F327353C0F897DEBF1EE573402F4F244096A771407CD4D9BD90F10640D016CA3E59506AC0BB46ABC0A6FA58C066C141C0F9B096C0BD8798C0E608E83FC81798BFA111E73F97FAB73F8965D9C0EDF672400FC6E13F84C308C024E582C0FC5A8FBE5FFC15C06CA7404011C8CCC0780F52408AED7BBEBF23723FDEF11EBF98B8D53D1AA9833E48BDB43E40BC86BF5C500BBE2465363E4FB373406950C13FF08A973F501C854084BE5940BDB284C052968CC090F7063F6C33C5408923A93FFCBD2DC0B80DBA3F193FC0BFA10B874088F7F1BFE06E48BD3E2ED5BF1508EE3E9AE71B3FADD882C06D0F04C0B142973FB159EA407EA29C3F413B11C00EDBC1BFF603A53F22037EBFA32F56C03247D0C078623140643123BFF63D83C0B95A1CC0AF87B2BFCF7995BF449245BF6B6EA84034E5AD3F776D31C03F2530BFFCE08FBFE12875BD943E283FEA32273F4337DD3FD960303E2B8F5840A9700BC0658F0B40EFFCBDBF7D92D33F9598B9400447B6BF05029F408EB5013FD724E33F8AED03BFD6077E40681198C0E8D261BF192AAD3E2DD71DC04342363F3EA9D6BE530020C067A15CC0E4C594BFB86701C1732E30BFA4C8F8BFBD1EBE400FAE1B402870663F1FB9B8C0A881D53F25EC9640023FC2BF6995793F6B1B473F678E573E3BC11BBFDCBC8DC0E37AE73F473D784013454940C2D2404087FD473F6AB380403D3DAE3DB0E15140F5FAD6BFA9C3A44099EBBDBFF5624CC0204805C09E3A10407702F8BFE5604EC0C6E13DC0D78922C0F634A4BF349E913F7F588440EB2251BFB988243FE89D8A40147CD540B01A263FDF1803C112E840BF6E32C43F6BF5F2BF6D7631BF678A00411A7C4A3FBA7B58C0232EB93F122EA53FB5CF1BC0C63DAC402CDC6CC04569B3BF815FA8BFB18598C0A56417C007E7D73FC3535D3FC828ECBF43CC79C05151003F3176D33F5B856840A26B63C0AA0D034035408ABF"> : tensor<4x4x3x4x2xf32>
    %cst_1 = stablehlo.constant dense<"0x0000000047E81A3EB118803FB118803F00000000000000002D038C3FA81FC33F5045AE3FDDB7353FB118803FB118803F00000000000000000000000000000000B17C563EF89CC43EB118803FB118803FB118803F00000000B118004000000000B118803F5013833FF8032F40C3D22640A8ED973FA851EE3FB1180040000000000000000000000000B118803FBAA7BE3C000000001BADBB3FB118803FB118803F00000000A851EE3E12B4FE3FCCFD0E3EB14AAB3FBAA73E3DB118803F00000000B11800400000000000000000000000000000000000000000B118803FB118803FB1180040B118803F12B71240B11800403EBDB23F01FAD73F0000000000000000B118803FB118803F5013833F85DDA03E0000000000000000B118004000000000B118803FA8ED173F1BAD3B3F35609F3F9FC22F3FB1180040474C713F474C713FB118803FB118803F0925C03F0925C03F00000000000000005013833E00000000F89CC43EB118803F00000000000000000096813FBAA73E3CB118803FB118803F6B5CE83FA851EE3F01C82C3FB17CD63FB118803F5077D93FBAA73E3CBAA73E3C00000000B118803FEF0D063FEF0D063F6AF8113FD58CCD3F474C713F12E93D40CCFD0E3DCCFD0E3DB118803FB118803F00000000B118803F0000000000000000A851EE3F59092C40B118803F474CF13FB118803FB118004000000000000000000000000000000000DDB7353FBAD9E93FB118803F00000000B118803FB118803F0000000000000000A81FC33F000000000096813F00000000BAA7BE3CA851EE3DBAA7BE3DBAA7BE3DB118803F85DDA03F00000000000000009F90843FBAA7BE3DD45AA23F47E89A3F6B2ABD3F35609F3FCC61653F0000000000000000B118803F2D67623FDD858A3FCCFD0E3D000000003692CA3E0000000009F3943EB118803F00000000BAA73E3CB118803F12E93D40B118803FB1180040B118803F00000000B118004000000000B118803F000000006B5CE83E5013833E474C713F00000000A851EE3D3EBD323EB118803FA81FC33FB118803FA81FC33F2D030C3F000000000000000062CDA93FB118803F12E93D40000000000000000047E81A3FA851EE3E7CB2B83FD4C10C40D58CCD3FB1180040B118803F00000000B118803F00000000B118803F00000000B118803F00000000B118803F00000000B118803F00000000C3D2263F62FFD43F7CB2B83EF86A993F2D67E23E62CD293F01FAD73F0925C03F62CD293F0000000000000000BAA7BE3FB118803FEF0D863F0000000001C8AC3EF89CC43E01C8AC3E00000000B118803F000000000000000000000000B118803FC336FD3F7CE4E33FB118803F00000000243C7A3F01FAD73FB118803F7CE4E33FD4C10C407CE4E33F00000000A8516E3DB118803F00000000B118803F00000000B11800400000000000000000000000000000000000000000B1180040B118803F01C82C3F5013833FC3D2263F0096813F0000000000000000B1180040CC61E53F000000000000000000000000C3D2A63EB118803F000000000000000000000000B1180040EF715C3FB118803F00000000B118803F00000000B118803F00000000"> : tensor<4x4x3x3x2xf32>
    %0 = stablehlo.uniform_quantize %cst_0 : (tensor<4x4x3x4x2xf32>) -> tensor<4x4x3x4x2x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %1 = stablehlo.uniform_quantize %cst : (tensor<4x4x3x3x4xf32>) -> tensor<4x4x3x3x4x!quant.uniform<i8:f32, 0.0039213846711551445:-128>>
    %2 = stablehlo.dot_general %1, %0, batching_dims = [0, 1, 2] x [0, 1, 2], contracting_dims = [4] x [3] : (tensor<4x4x3x3x4x!quant.uniform<i8:f32, 0.0039213846711551445:-128>>, tensor<4x4x3x4x2x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>) -> tensor<4x4x3x3x2x!quant.uniform<i32:f32, 1.5377899358457782E-5>>
    %3 = stablehlo.uniform_quantize %2 : (tensor<4x4x3x3x2x!quant.uniform<i32:f32, 1.5377899358457782E-5>>) -> tensor<4x4x3x3x2x!quant.uniform<i8:f32, 0.011636668560551662:-128>>
    %4 = stablehlo.uniform_dequantize %3 : (tensor<4x4x3x3x2x!quant.uniform<i8:f32, 0.011636668560551662:-128>>) -> tensor<4x4x3x3x2xf32>
    %5 = stablehlo.custom_call @check.eq(%cst_1, %4) : (tensor<4x4x3x3x2xf32>, tensor<4x4x3x3x2xf32>) -> tensor<i1>
    return %5 : tensor<i1>
  }
}
